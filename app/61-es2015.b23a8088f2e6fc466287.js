(window.webpackJsonp=window.webpackJsonp||[]).push([[61],{"6aA7":function(e,t,n){"use strict";n.r(t),n.d(t,"EmulationPageModule",function(){return b});var i=n("SVse"),o=n("iInd"),a=n("mrSG"),s=n("8Y7J"),c=n("bucj"),l=n("sZkV");const r=["canvas"],h=3*devicePixelRatio;function d(e,t,n,i){const o=e.measureText(i);e.textBaseline="middle",e.fillText(i,t-o.width/2,n)}const u=[{path:"",component:(()=>{class e{constructor(e,t){this.emulationService=e,this.ngZone=t,this.handeMouseEvent=e=>{const t=this.eventToPalmCoordinates(e);1&e.buttons?t&&this.emulationService.handlePointerMove(...t):this.emulationService.handlePointerUp()},this.handleTouchEvent=e=>{if(e.touches.length>0){const t=this.eventToPalmCoordinates(e.touches.item(0));t&&this.emulationService.handlePointerMove(...t)}else this.emulationService.handlePointerUp();e.preventDefault()},this.onNewFrame=e=>{this.canvasRef.nativeElement.getContext("2d").drawImage(e,0,0,160*h,160*h)}}ngAfterViewInit(){const e=this.canvasRef.nativeElement,t=e.getContext("2d");t.imageSmoothingEnabled=!1,t.beginPath(),t.rect(0,0,160*h,160*h),t.fillStyle="#ccc",t.fill(),this.drawSilkscreen(),this.drawButtons(),this.ngZone.runOutsideAngular(()=>{e.addEventListener("mousedown",this.handeMouseEvent),e.addEventListener("mouseup",this.handeMouseEvent),e.addEventListener("mousemove",this.handeMouseEvent),e.addEventListener("touchstart",this.handleTouchEvent),e.addEventListener("touchmove",this.handleTouchEvent),e.addEventListener("touchend",this.handleTouchEvent),e.addEventListener("touchcancel",this.handleTouchEvent)})}get canvasWidth(){return 160*h}get canvasHeight(){return 250*h}ionViewDidEnter(){this.emulationService.newFrame.addHandler(this.onNewFrame),this.emulationService.resume()}ionViewWillLeave(){this.emulationService.pause(),this.emulationService.newFrame.removeHandler(this.onNewFrame)}drawSilkscreen(){return Object(a.a)(this,void 0,void 0,function*(){const e=new Image;yield new Promise((t,n)=>{e.onload=()=>t(),e.onerror=()=>n(),e.src="assets/silkscreen.png"});const t=this.canvasRef.nativeElement.getContext("2d");t.beginPath(),t.rect(0,160*h,160*h,60*h),t.fillStyle="#eee",t.fill(),t.imageSmoothingEnabled=!0,t.imageSmoothingQuality="high",t.drawImage(e,0,160*h,160*h,60*h),t.imageSmoothingEnabled=!1})}drawButtons(){const e=this.canvasRef.nativeElement.getContext("2d");e.beginPath(),e.rect(0,220*h,160*h,30*h),e.fillStyle="white",e.fill(),e.beginPath(),e.lineWidth=3,e.strokeStyle="black",e.moveTo(0,220*h),e.lineTo(160*h,220*h),e.moveTo(30*h,220*h),e.lineTo(30*h,250*h),e.moveTo(60*h,220*h),e.lineTo(60*h,250*h),e.moveTo(130*h,220*h),e.lineTo(130*h,250*h),e.moveTo(100*h,220*h),e.lineTo(100*h,250*h),e.moveTo(60*h,235*h),e.lineTo(100*h,235*h),e.stroke(),e.font=10*h+"px sans",e.fillStyle="black",d(e,15*h,235*h,"D"),d(e,45*h,235*h,"P"),d(e,115*h,235*h,"T"),d(e,145*h,235*h,"N")}eventToPalmCoordinates(e){const t=this.canvasRef.nativeElement.getBoundingClientRect();let n,i,o,a;t.width/t.height>.64?(a=t.height,o=.64*t.height,i=t.top,n=t.left+(t.width-o)/2):(o=t.width,a=1.5625*t.width,n=t.left,i=t.top+(t.height-a)/2);const s=Math.floor((e.clientX-n)/o*160),c=Math.floor((e.clientY-i)/a*250);if(!(s<0||s>=160||c<0||c>=220))return[s,c]}}return e.\u0275fac=function(t){return new(t||e)(s.Jb(c.a),s.Jb(s.B))},e.\u0275cmp=s.Db({type:e,selectors:[["app-emulation"]],viewQuery:function(e,t){if(1&e&&s.jc(r,1),2&e){let e;s.ac(e=s.Vb())&&(t.canvasRef=e.first)}},decls:18,vars:2,consts:[["slot","end"],["name","power-outline"],["name","add-outline"],["slot","start"],["name","ellipsis-vertical-outline"],["name","checkmark-circle-outline"],[1,"container"],[3,"width","height"],["canvas",""]],template:function(e,t){1&e&&(s.Mb(0,"ion-header"),s.Mb(1,"ion-toolbar"),s.Mb(2,"ion-title"),s.fc(3,"Emulator"),s.Lb(),s.Mb(4,"ion-buttons",0),s.Mb(5,"ion-button"),s.Kb(6,"ion-icon",1),s.Lb(),s.Mb(7,"ion-button"),s.Kb(8,"ion-icon",2),s.Lb(),s.Lb(),s.Mb(9,"ion-buttons",3),s.Mb(10,"ion-button"),s.Kb(11,"ion-icon",4),s.Lb(),s.Mb(12,"ion-button"),s.Kb(13,"ion-icon",5),s.Lb(),s.Lb(),s.Lb(),s.Lb(),s.Mb(14,"ion-content"),s.Mb(15,"div",6),s.Kb(16,"canvas",7,8),s.Lb(),s.Lb()),2&e&&(s.zb(16),s.Zb("width",t.canvasWidth)("height",t.canvasHeight))},directives:[l.f,l.s,l.r,l.d,l.c,l.g,l.e],styles:["ion-title[_ngcontent-%COMP%]{text-align:center}.container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center;padding:5px}canvas[_ngcontent-%COMP%]{max-width:100%;max-height:100%;height:750px;width:480px;-o-object-fit:contain;object-fit:contain}"]}),e})()}];let v=(()=>{class e{}return e.\u0275mod=s.Hb({type:e}),e.\u0275inj=s.Gb({factory:function(t){return new(t||e)},imports:[[o.i.forChild(u)],o.i]}),e})();var m=n("s7LF");let b=(()=>{class e{}return e.\u0275mod=s.Hb({type:e}),e.\u0275inj=s.Gb({factory:function(t){return new(t||e)},imports:[[i.b,m.a,l.t,v]]}),e})()}}]);